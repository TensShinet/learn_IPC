# Posix 信号量基础



> 前言：书上这一章的内容真多，一点点总结，废话不多说，让我们开始





![](http://nobathroomneeded.files.wordpress.com/2009/08/initial-d.jpg)



`今天不开车，拿停车场举个例子`



## 0X00 信号量的感性认识

之前我们学了「互斥锁」和「条件变量」，互斥锁只让某一块代码被一个多线程的一个线程执行，而条件变量可以让线程阻塞，然后一旦某个条件满足了，还可以被唤醒



`今天学习的信号量是两者的结合，可用在单纯上锁，还可用在等待唤醒`



在知乎上看到了一个信号量的解释，描述的很有画面感：



信号量就是`停车场还能停车子多少车子`，它的最大值：该停车场能停多少车子，它的当前值：如果当前值大于 0，那么是停车场还能停多少车子，如果当前值小于等于 0，那么代表停车场已经满了，这个值的绝对值代表着有多少车子在排队



信号量有两个基本操作：等待（wait）和挂出（post）



1) 等待（wait）的意思就是，有一个车子要进来了，停车场还能停车子，如果停车场满了，该值小于等于 0 了，那么车子就要等待，此时这个值还要减一，因为又多了一辆等待的车子



2) 挂出（post）的意思就是，有一个车子要走了，停车场多了一个位子，该值加 1，让一个等待的车子进来



`如果没有读懂我说的这个例子，建议阻塞一下，好好理解一下信号量是个啥`



说完了感性的理解，我们来看一下，「信号量」在 POSIX 标准下的分类



+ **有名信号量：使用 POSIX IPC 名字标识，可用于进程或线程间的同步**
+ **POSIX 基于内存的信号量：存放在共享内存中，可用于进程或线程间的同步**





## 0X01 信号量部分相关函数解释



**接下来我们介绍与「有名信号量」有关的函数**













## 0X02 程序举例





### 用信号量实现环形缓冲区的生产者消费者问题



### 用信号量给文件上锁







